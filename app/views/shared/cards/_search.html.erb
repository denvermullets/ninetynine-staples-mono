<div class='flex-1 w-auto' id='search-form'>
  <%= form_with url: search_path, method: :get, local: false,
    data: {
      controller: 'search-filter',
      action: 'submit->search-filter#submit',
      search_filter_target: 'form',
      search_filter: 'form' } do |form| %>
    <div class="flex flex-row flex-wrap  gap-4" data-controller="multiselect">
      <!-- Search Field -->
      <div class="flex-1 min-w-[200px] max-w-[400px]">
        <div class='flex flex-col'>
          <h3 class='mb-2 text-grey-text'>Search</h3>
          <div class='flex flex-row space-x-0'>
            <%= form.text_field :search,
              value: params[:search],
              placeholder: 'Enter card name or type',
              onfocus: "this.select();",
              class: 'w-full border text-grey-text rounded-l-md bg-background border-highlight focus:border-accent-50 focus:ring-accent-50'
          %>
            <%= form.hidden_field :username, value: params[:username] %>
            <%= form.hidden_field :code, value: params[:code] %>
            <%= form.hidden_field :collection_id, value: params[:collection_id] %>
            <%= form.submit 'Search',
              class: 'p-2 bg-background text-grey-text rounded-r-md border border-highlight hover:cursor-pointer hover:bg-gray-700'
          %>
          </div>
          <p class='mt-2 text-xs text-grey-text'>Search for a card</p>
        </div>
      </div>
      <!-- Mana Filter -->
      <div class="flex-1 min-w-[200px]">
        <div class='flex flex-col'>
          <h3 class="mb-2 text-grey-text">Mana</h3>
          <div class="flex flex-row flex-wrap">
            <% ['b', 'u', 'w', 'r', 'g', 'c'].each do |mana| %>
              <button
              type="button"
              data-action="click->multiselect#toggle"
                data-multiselect-target="item"
                data-multiselect-group="mana"
                data-value="<%= mana.upcase %>"
                class="cursor-pointer rounded-full p-2 transition border-2 border-transparent data-selected:border-accent-50 data-selected:bg-accent-50/20"
                >
                <i class="no-tailwind ms ms-cost ml-0 ms-2x <%= "ms-#{mana}" %>"></i>
              </button>
            <% end %>
          </div>
          <p class='mt-2 text-xs text-grey-text'>Select color to filter by</p>
        </div>
      </div>
      <!-- Rarity Filter -->
      <div class="flex-1 min-w-[200px]">
        <div class='flex flex-col'>
          <h3 class='mb-2 text-grey-text'>Rarity</h3>
          <div class='flex flex-row flex-wrap'>
            <% ['mythic', 'rare', 'uncommon', 'common'].each do |rarity| %>
              <button
              type="button"
              data-action="click->multiselect#toggle"
                data-multiselect-target="item"
                data-multiselect-group="rarity"
                data-value="<%= rarity %>"
                class="cursor-pointer rounded-full p-2 transition border-2 border-transparent data-selected:border-accent-50 data-selected:bg-accent-50/20"
                >
                <i class='no-tailwind ms ms-cost ml-0 ms-rarity ms-2x'></i>
              </button>
            <% end %>
          </div>
          <p class='mt-2 text-xs text-grey-text'>Select rarity to filter by</p>
        </div>
      </div>
    </div>
    <!-- Hidden fields for selected filters -->
    <div id="filter-hidden-fields"></div>
  <% end %>
</div>
