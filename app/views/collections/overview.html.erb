<div
  class="
    flex flex-col flex-auto h-auto px-4 space-y-8 md:px-12 2xl:px-48
    bg-dark-100
  "
>
  <%= render partial: 'shared/page_header',
    locals: { header: "#{@user.username}'s Collections",
              subtext: @is_owner ? 'Manage your collections and decks.' : "Browse #{@user.username}'s collection." } %>

  <div
    class="
      flex flex-col sm:flex-row justify-between items-start sm:items-center
      gap-4
    "
  >
    <% if @is_owner %>
      <%= link_to new_collection_path,
          class: 'px-4 py-2 bg-accent-50 text-background rounded-lg border border-accent-50 hover:bg-foreground hover:text-accent-50 transition cursor-pointer' do %>
        + New Collection
      <% end %>
    <% else %>
      <div></div>
    <% end %>
  </div>

  <% if @regular_collections.any? %>
    <div
      data-controller="collapsible"
      data-collapsible-expanded-value="true"
      class="space-y-4"
    >
      <button
        type="button"
        data-action="click->collapsible#toggle"
        class="flex items-center gap-2 cursor-pointer group"
      >
        <h2 class="text-xl font-semibold text-grey-text">Collections</h2>

        <svg
          data-collapsible-target="icon"
          class="w-5 h-5 text-grey-text transition-transform duration-200"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>
      </button>

      <div
        data-collapsible-target="content"
        class="
          grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4
          gap-6
        "
      >
        <% @regular_collections.each do |collection| %>
          <%= render partial: 'shared/collection_card', locals: {
            collection: collection,
            link_path: collection_show_path(username: @user.username, collection_id: collection.id),
            is_owner: @is_owner,
            edit_url: edit_collection_modal_collection_path(collection),
            frame_id: 'collection_modal'
          } %>
        <% end %>
      </div>
    </div>
  <% end %>

  <% if @deck_collections.any? %>
    <div
      data-controller="collapsible"
      data-collapsible-expanded-value="true"
      class="space-y-4"
    >
      <button
        type="button"
        data-action="click->collapsible#toggle"
        class="flex items-center gap-2 cursor-pointer group"
      >
        <h2 class="text-xl font-semibold text-grey-text">Decks</h2>

        <svg
          data-collapsible-target="icon"
          class="w-5 h-5 text-grey-text transition-transform duration-200"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>
      </button>

      <div
        data-collapsible-target="content"
        class="
          grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4
          gap-6
        "
      >
        <% @deck_collections.each do |collection| %>
          <%= render partial: 'shared/collection_card', locals: {
            collection: collection,
            link_path: deck_show_path(username: @user.username, collection_id: collection.id),
            is_owner: @is_owner,
            edit_url: edit_collection_modal_collection_path(collection),
            frame_id: 'collection_modal',
            show_proxy_value: true
          } %>
        <% end %>
      </div>
    </div>
  <% end %>

  <% if @regular_collections.empty? && @deck_collections.empty? %>
    <div class="border rounded-3xl bg-foreground border-highlight p-12 text-center">
      <p class="text-lg text-grey-text mb-4">
        <% if @is_owner %>
          You don't have any collections yet.
        <% else %>
          <%= @user.username %>
          doesn't have any collections yet.
        <% end %>
      </p>

      <% if @is_owner %>
        <%= link_to 'Create Your First Collection', new_collection_path,
            class: 'inline-block px-6 py-3 bg-accent-50 text-background rounded-lg border border-accent-50 hover:bg-foreground hover:text-accent-50 transition cursor-pointer' %>
      <% end %>
    </div>
  <% end %>

  <%= turbo_frame_tag "collection_modal" %>
</div>
