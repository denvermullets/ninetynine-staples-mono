<div
  class="
    flex flex-col flex-auto h-auto px-4 space-y-8 md:px-12 2xl:px-48
    bg-dark-100
  "
>
  <%= render partial: 'shared/page_header',
    locals: { header: @is_owner ? 'Tracked Decks' : "#{tracker_owner.username}'s Decks",
              subtext: @is_owner ? 'Track your Commander decks and record games to see your performance statistics.' : 'Commander decks and performance statistics.' } %>

  <div class="flex justify-between items-center">
    <% if @is_owner %>
      <%= link_to new_tracked_deck_path, class: 'px-4 py-2 bg-accent-50 text-background rounded-lg border border-accent-50 hover:bg-foreground hover:border-accent-50 hover:text-accent-50 font-medium cursor-pointer' do %>
        + New Tracked Deck
      <% end %>
    <% end %>

    <%= link_to 'View Dashboard', game_tracker_path(tracker_owner.username), class: 'px-4 py-2 border border-highlight text-grey-text rounded-lg hover:bg-foreground hover:border-accent-50 hover:text-accent-50 cursor-pointer' %>
  </div>

  <div class="border rounded-3xl bg-foreground border-highlight overflow-hidden">
    <% if @tracked_decks.any? %>
      <table class="min-w-full">
        <thead class="bg-background">
          <tr>
            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider
              "
            >
              Deck
            </th>

            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider hidden md:table-cell
              "
            >
              Commander
            </th>

            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider
              "
            >
              Games
            </th>

            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider
              "
            >
              Win Rate
            </th>

            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider hidden lg:table-cell
              "
            >
              Status
            </th>

            <th
              class="
                px-6 py-3 text-left text-xs font-medium text-grey-text
                uppercase tracking-wider hidden lg:table-cell
              "
            >
              Last Played
            </th>
          </tr>
        </thead>

        <tbody class="divide-y divide-highlight">
          <% @tracked_decks.each do |deck| %>
            <tr
              class="hover:bg-background/50 cursor-pointer"
              onclick="window.location='<%= game_tracker_tracked_deck_path(tracker_owner.username, deck) %>'"
            >
              <td class="px-6 py-4">
                <div class="flex items-center gap-3">
                  <% if deck.commander.image_small.present? %>
                    <%= image_tag deck.commander.image_small,
                      alt: deck.commander.name,
                      class: "w-10 h-14 rounded object-cover hidden sm:block cursor-pointer",
                      data: {
                        controller: "card-hover",
                        card_hover_image_value: deck.commander.image_large,
                        card_hover_name_value: deck.commander.name,
                        action: "mouseenter->card-hover#show mouseleave->card-hover#hide mousemove->card-hover#move"
                      } %>
                  <% end %>

                  <div class="flex flex-col">
                    <span class="text-grey-text font-medium">
                      <%= deck.name %>
                    </span>

                    <span class="text-grey-text text-sm md:hidden">
                      <%= deck.commander_display_name.truncate(30) %>
                    </span>
                  </div>
                </div>
              </td>

              <td class="px-6 py-4 text-grey-text hidden md:table-cell">
                <%= deck.commander_display_name %>
              </td>

              <td class="px-6 py-4 text-grey-text">
                <span class="text-accent-50"><%= deck.wins_count %>W</span> /
                <span class="text-accent-100"><%= deck.losses_count %>L</span>
              </td>

              <td class="px-6 py-4">
                <span class="<%= deck.win_rate >= 50 ? 'text-accent-50' : 'text-accent-100' %>">
                  <%= deck.win_rate %>%
                </span>
              </td>

              <td class="px-6 py-4 hidden lg:table-cell">
                <span class="px-2 py-1 rounded-full text-xs <%= deck.status_badge_class %>">
                  <%= deck.status.titleize %>
                </span>
              </td>

              <td class="px-6 py-4 text-grey-text hidden lg:table-cell">
                <%= deck.last_played_on&.strftime('%b %d, %Y') || 'Never' %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <div class="p-8 text-center">
        <p class="text-lg text-grey-text mb-4">No tracked decks yet</p>

        <% if @is_owner %>
          <p class="text-grey-text mb-6">
            Start tracking a deck to record your games and see performance
            statistics.
          </p>
          <%= link_to '+ Add Your First Deck', new_tracked_deck_path, class: 'px-4 py-2 bg-accent-50 text-background rounded-lg border border-accent-50 hover:bg-foreground hover:border-accent-50 hover:text-accent-50 cursor-pointer' %>
        <% else %>
          <p class="text-grey-text">This user hasn't tracked any decks yet.</p>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
